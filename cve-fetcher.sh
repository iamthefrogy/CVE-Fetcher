#!/bin/bash
echo -e "

 ██████ ██    ██ ███████       ███████ ███████ ████████  ██████ ██   ██ ███████ ██████
██      ██    ██ ██            ██      ██         ██    ██      ██   ██ ██      ██   ██
██      ██    ██ █████   █████ █████   █████      ██    ██      ███████ █████   ██████
██       ██  ██  ██            ██      ██         ██    ██      ██   ██ ██      ██   ██
 ██████   ████   ███████       ██      ███████    ██     ██████ ██   ██ ███████ ██   ██

"
# Check if the user has provided a CVE ID
  echo "Usage: $0 <CVE-ID>"
  exit 1
fi

CVE_ID=$1

# Fetch CVE information using NVD API
CVE_DATA=$(curl -s "https://services.nvd.nist.gov/rest/json/cve/1.0/$CVE_ID")

# Extract relevant information using 'jq'
CVE_TITLE=$(echo "$CVE_DATA" | jq -r '.result.CVE_Items[0].cve.description.description_data[0].value')
AFFECTED_PRODUCTS=$(echo "$CVE_DATA" | jq -r '.result.CVE_Items[0].configurations.nodes[].cpe_match[] | "\(.cpe23Uri) version: \(.versionEndIncluding)"')

# Print the results
echo -e "\e[92mCVE Title:\e[0m\n$CVE_TITLE"
echo -e "\e[92mAffected Products and Versions:\e[0m"
echo "$AFFECTED_PRODUCTS"